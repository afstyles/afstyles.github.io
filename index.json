[{"authors":["admin"],"categories":null,"content":"I am a DPhil (PhD) student studying physical oceanography at the University of Oxford, where I am supervised by David Marshall and Mike Bell.\nMy research is all about the fluid dynamics of the ocean and how important circulations are represented in ocean models.\nI study the dynamics of ocean gyres and how they are influenced by eddy activity, the sea floor, and buoyancy forcing. I tackle this research question by designing idealized models, developing diagnostic methods, analyzing Lagrangian trajectories, and exploring possibilities with pen and paper analysis.\nPlease reach out to me if you would like to meet or collaborate!\n   image/svg+xml     Idealized modeling   Diagnostic methods   Lagrangian trajectories  Pen and paper analysis  ∳   dl   Icons made with Inkscape\n\n","date":-62135596800,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://afstyles.github.io/author/andrew-styles/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/andrew-styles/","section":"authors","summary":"I am a DPhil (PhD) student studying physical oceanography at the University of Oxford, where I am supervised by David Marshall and Mike Bell.\nMy research is all about the fluid dynamics of the ocean and how important circulations are represented in ocean models.","tags":null,"title":"Andrew Styles","type":"authors"},{"authors":null,"categories":null,"content":"After four years I have finally finished my PhD at the University of Oxford. An enormous thanks to my two fantastic supervisors, David Marshall and Mike Bell, for their guidance and support. I must also thank my two examiners, Alberto Naveira Garabato and Andrew Wells.\nI am taking some much-needed time off, but I will be starting a very unique research project very soon. Stay tuned for more details!\n","date":1697155200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1697155200,"objectID":"05bd68d036dc35d3037f34ca4196519f","permalink":"https://afstyles.github.io/post/phdone/","publishdate":"2023-10-13T00:00:00Z","relpermalink":"/post/phdone/","section":"post","summary":"After four years I have finally finished my PhD at the University of Oxford. An enormous thanks to my two fantastic supervisors, David Marshall and Mike Bell, for their guidance and support.","tags":null,"title":"Finished my PhD!","type":"post"},{"authors":null,"categories":null,"content":"The second paper from my PhD has just been published in JGR: Oceans!\nUse the link below to take a look!\n https://doi.org/10.1029/2023JC019711\nIn this paper, we use an idealized model of the Weddell Gyre and find that it is extremely sensitive to horizontal resolution. In particular, the gyre transport is largest at eddy-permitting resolutions, where only the largest mesoscale eddies are resolved.\n","date":1696464000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1696464000,"objectID":"9524a27aa659c49b9e7a4398b9fe3a14","permalink":"https://afstyles.github.io/post/iwg-published/","publishdate":"2023-10-05T00:00:00Z","relpermalink":"/post/iwg-published/","section":"post","summary":"The second paper from my PhD has just been published in JGR: Oceans!\nUse the link below to take a look!\n https://doi.org/10.1029/2023JC019711\nIn this paper, we use an idealized model of the Weddell Gyre and find that it is extremely sensitive to horizontal resolution.","tags":null,"title":"Idealized Weddell Gyre paper published!","type":"post"},{"authors":["Andrew F. Styles","Michael J. Bell","David P. Marshall"],"categories":null,"content":"","date":1695427200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1695427200,"objectID":"f00c05b755bb0938a96d23576da69ec8","permalink":"https://afstyles.github.io/publication/iwg_sensitivity/","publishdate":"2023-09-23T00:00:00Z","relpermalink":"/publication/iwg_sensitivity/","section":"publication","summary":"Estimates of the Weddell Gyre transport vary widely between climate simulations. Here, we investigate if inter-model variability can originate from differences in the horizontal resolution of the ocean model. We run an idealized model of the Weddell Gyre at eddy-parameterized, eddy-permitting, and eddy-rich resolutions and find that the gyre is strongly sensitive to horizontal resolution. The gyre transport is largest at eddy-permitting resolutions (45 Sv with a noisy bathymetry) and smallest at eddy-parameterized resolutions (12 Sv). The eddy-permitting simulations have the largest horizontal density gradients and the weakest stratification over the gyre basin. The large horizontal density gradients induce a significant thermal wind transport and increase the mean available potential energy for mesoscale eddies. The distribution of eddy kinetic energy indicates that explicit eddies in simulations intensify the bottom circulation of the gyre via non-linear dynamics. If climate models adopt horizontal resolutions that the Weddell Gyre is most sensitive to, then simulations of the Weddell Gyre could become more disparate.","tags":["Weddell Gyre","Idealized Modeling","Mesoscale Eddies","Resolution","Sea floor interaction","Antarctic Circumpolar Current"],"title":"The Sensitivity of an Idealized Weddell Gyre to Horizontal Resolution","type":"publication"},{"authors":null,"categories":null,"content":"Tomorrow (Tuesday, 27th June) I will be visiting Southampton to give a seminar at 11am in the National Oceanography Centre. If you are in Southampton and would like to meet, let me know!\nThe seminar is all about the idealized model of the Weddell Gyre that I created and have used throughout my PhD. I will show how this model is extremely sensitive to horizontal resolution and that eddy-permitting (1/4 degree) resolutions can be particularly problematic.\nThe seminar will be based on my paper that is under review at JGR: Oceans (link to preprint here).\n","date":1687737600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1687737600,"objectID":"af49d76c686e8a6b1355f4f1f7ae8b07","permalink":"https://afstyles.github.io/post/southampton-seminar23/","publishdate":"2023-06-26T00:00:00Z","relpermalink":"/post/southampton-seminar23/","section":"post","summary":"Tomorrow (Tuesday, 27th June) I will be visiting Southampton to give a seminar at 11am in the National Oceanography Centre. If you are in Southampton and would like to meet, let me know!","tags":null,"title":"Visiting Southampton","type":"post"},{"authors":null,"categories":null,"content":"This week I will be visiting the British Antarctic Survey for two days (31st May - 1st June). If you are at BAS or Cambridge and would like to meet, let me know!\nOn Wednesday 31st May at 3 pm (BST) I will be presenting at the British Antarctic Survey (BAS) as part of the Polar Ocean seminar series (link here).\nThe seminar is all about the idealized model of the Weddell Gyre that I created and have used throughout my PhD. I will show how this model is extremely sensitive to horizontal resolution and that eddy-permitting (1/4 degree) resolutions can be particularly problematic.\nThe seminar will be based on my paper that is under review at JGR: Oceans (link to preprint here).\n","date":1684886400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1684886400,"objectID":"0bc4fa561b8ebbca946c5928d3a5bde1","permalink":"https://afstyles.github.io/post/bas-seminar23/","publishdate":"2023-05-24T00:00:00Z","relpermalink":"/post/bas-seminar23/","section":"post","summary":"This week I will be visiting the British Antarctic Survey for two days (31st May - 1st June). If you are at BAS or Cambridge and would like to meet, let me know!","tags":null,"title":"Visiting the British Antarctic Survey","type":"post"},{"authors":null,"categories":null,"content":"On Tuesday this week I will be presenting at the University of Liverpool as part of the Ocean seminar series.\nThe seminar is all about the idealized model of the Weddell Gyre that I created and have used throughout my PhD. I will show how this model is extremely sensitive to horizontal resolution and that eddy-permitting (1/4 degree) resolutions can be particularly problematic.\nThe seminar will be based on the paper I have submitted to JGR: Oceans (preprint here) which has just received some very positive reviews!\n","date":1679270400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1679270400,"objectID":"030168864737430bb3283d05ce64276b","permalink":"https://afstyles.github.io/post/liverpool-seminar23/","publishdate":"2023-03-20T00:00:00Z","relpermalink":"/post/liverpool-seminar23/","section":"post","summary":"On Tuesday this week I will be presenting at the University of Liverpool as part of the Ocean seminar series.\nThe seminar is all about the idealized model of the Weddell Gyre that I created and have used throughout my PhD.","tags":null,"title":"Seminar at the University of Liverpool","type":"post"},{"authors":null,"categories":null,"content":"I am absolutely delighted to announce that I have received an Outstanding Student Presentation Award (OSPA) for my talk at AGU22.\nThanks to the judges for their helpful feedback and most importantly thanks to all the attendees I met in Chicago who shared their incredible research.\n","date":1677110400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1677110400,"objectID":"61fd6eaaeff130c1d341dc25916633dd","permalink":"https://afstyles.github.io/post/ospa2022/","publishdate":"2023-02-23T00:00:00Z","relpermalink":"/post/ospa2022/","section":"post","summary":"I am absolutely delighted to announce that I have received an Outstanding Student Presentation Award (OSPA) for my talk at AGU22.\nThanks to the judges for their helpful feedback and most importantly thanks to all the attendees I met in Chicago who shared their incredible research.","tags":null,"title":"Outstanding Student Presentation Award at AGU!","type":"post"},{"authors":null,"categories":null,"content":"I am excited to announce that I have submitted my second paper to JGR: Oceans and the preprint is now available on ESS Open Archive.\nUse the link below to take a look!\n https://doi.org/10.22541/essoar.167591042.21189159/v1\nIn this paper, we use an idealized model of the Weddell Gyre and find that it is extremely sensitive to horizontal resolution. In particular, the gyre transport is largest at eddy-permitting resolutions, where only the largest mesoscale eddies are resolved.\n","date":1675900800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1675900800,"objectID":"d4f91650f0c10e3c4a0ff1a4bd3ca88f","permalink":"https://afstyles.github.io/post/iwg-preprint/","publishdate":"2023-02-09T00:00:00Z","relpermalink":"/post/iwg-preprint/","section":"post","summary":"I am excited to announce that I have submitted my second paper to JGR: Oceans and the preprint is now available on ESS Open Archive.\nUse the link below to take a look!","tags":null,"title":"Preprint of my second paper is out!","type":"post"},{"authors":null,"categories":null,"content":"This year I will be presenting my work at the AGU 2022 conference in Chicago.\nI will be presenting two posters:\n  My recently published work on spurious forces in the Community Modeling and Open Innovation session on Wednesday, 14th December at 14:45-18:15 CT (link here).\n  Recent results from an idealized model of the Weddell Gyre that demonstrate an extreme sensitivity to resolution on Friday, 16th December at 14:45-18:15 CT (link here)\n  See you in Chicago (or online)!\n","date":1670716800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1670716800,"objectID":"6c12e9dc7719f30c1d30f8b07c36c4d5","permalink":"https://afstyles.github.io/post/agu-2022-presentation/","publishdate":"2022-12-11T00:00:00Z","relpermalink":"/post/agu-2022-presentation/","section":"post","summary":"This year I will be presenting my work at the AGU 2022 conference in Chicago.\nI will be presenting two posters:\n  My recently published work on spurious forces in the Community Modeling and Open Innovation session on Wednesday, 14th December at 14:45-18:15 CT (link here).","tags":null,"title":"I will be presenting at AGU 2022","type":"post"},{"authors":null,"categories":null,"content":"It has been an incredible and jam-packed week in Paris. The joint meetings for SO-CHIC and OCEAN:ICE showcased some great science and I have met some incredible people. I was introduced to some exciting new observational datasets and I have learned so much about polynyas and their impact on the ocean and atmosphere.\nOn Thursday, I shared some results from my idealized model of the Weddell Gyre and you can find the slides here. I am now very energized to get this article written so keep an eye out for the preprint!\nIt was also my pleasure to share the poster from my recent publication about spurious forces. You can find a digital copy of the poster here.\n","date":1668124800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1668124800,"objectID":"6e04b0ceabf709b3ce2f5701404212bb","permalink":"https://afstyles.github.io/post/so-chic-thanks2022/","publishdate":"2022-11-11T00:00:00Z","relpermalink":"/post/so-chic-thanks2022/","section":"post","summary":"It has been an incredible and jam-packed week in Paris. The joint meetings for SO-CHIC and OCEAN:ICE showcased some great science and I have met some incredible people. I was introduced to some exciting new observational datasets and I have learned so much about polynyas and their impact on the ocean and atmosphere.","tags":null,"title":"Thanks for having me SO-CHIC and OCEAN:ICE","type":"post"},{"authors":null,"categories":null,"content":"I have a very exciting week lined up ahead of me. The joint meetings for SO-CHIC and OCEAN:ICE are taking place at Sorbonne University in Paris.\nOn Thursday, I will be sharing some results from my idealized model of the Weddell Gyre. I am currently writing an article for these new results and a preprint will be available soon so keep an eye out!\nI will also be giving a poster presentation on my recent publication about spurious forces in ocean gyres.\n","date":1667692800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1667692800,"objectID":"56f034abd4d56500bc29275c7e7da328","permalink":"https://afstyles.github.io/post/so-chic-announcement2022/","publishdate":"2022-11-06T00:00:00Z","relpermalink":"/post/so-chic-announcement2022/","section":"post","summary":"I have a very exciting week lined up ahead of me. The joint meetings for SO-CHIC and OCEAN:ICE are taking place at Sorbonne University in Paris.\nOn Thursday, I will be sharing some results from my idealized model of the Weddell Gyre.","tags":null,"title":"Invited talk at the SO-CHIC and OCEAN:ICE joint project meeting","type":"post"},{"authors":null,"categories":null,"content":"This week I will be presenting a seminar for the Geophysical and Astrophysical Fluid Dynamics group at the University of Exeter.\nThe seminar will be an in-depth study of ocean gyres and their vorticity budget and is largely based on my recently published paper.\nIf you are in Exeter, head over to the Harrison building on the 4th October at 14:30 BST to catch the talk.\nMore details can be found here.\n","date":1664668800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1664668800,"objectID":"0756f42df3d4e2b3071e9b419e34a197","permalink":"https://afstyles.github.io/post/exeter-seminar22/","publishdate":"2022-10-02T00:00:00Z","relpermalink":"/post/exeter-seminar22/","section":"post","summary":"This week I will be presenting a seminar for the Geophysical and Astrophysical Fluid Dynamics group at the University of Exeter.\nThe seminar will be an in-depth study of ocean gyres and their vorticity budget and is largely based on my recently published paper.","tags":null,"title":"Seminar at the University of Exeter","type":"post"},{"authors":null,"categories":null,"content":"The Ocean Modelling SIG was a fantastic meeting, jam-packed with great talks.\nIt is therefore a great honour to win the prize for best talk at the meeting alongside Andrea Rochner from Exeter\nUnfortunately a recording of the talk is not available but the slides can be found here.\n","date":1662681600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1662681600,"objectID":"7df8d395f61c38ea2153384d85640236","permalink":"https://afstyles.github.io/post/bestspeakeromg22/","publishdate":"2022-09-09T00:00:00Z","relpermalink":"/post/bestspeakeromg22/","section":"post","summary":"The Ocean Modelling SIG was a fantastic meeting, jam-packed with great talks.\nIt is therefore a great honour to win the prize for best talk at the meeting alongside Andrea Rochner from Exeter","tags":null,"title":"Best talk at Ocean Modelling SIG!","type":"post"},{"authors":null,"categories":null,"content":"I am very excited to be presenting in the Challenger Society Ocean Modelling annual meeting at the Natural History Museum in London.\nI will be presenting my work on spurious forces in the afternoon session (9th September 13:30 - 15:30 GMT)\nDespite my best efforts, I cannot guarantee that dinosaurs will be featured in my presentation!\n","date":1662076800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1662076800,"objectID":"e047bbd1ecd9d361c30ed27e2864a4f7","permalink":"https://afstyles.github.io/post/omg-2022-presentation/","publishdate":"2022-09-02T00:00:00Z","relpermalink":"/post/omg-2022-presentation/","section":"post","summary":"I am very excited to be presenting in the Challenger Society Ocean Modelling annual meeting at the Natural History Museum in London.\nI will be presenting my work on spurious forces in the afternoon session (9th September 13:30 - 15:30 GMT)","tags":null,"title":"See you at the Natural History Museum!","type":"post"},{"authors":["Andrew F. Styles","Michael J. Bell","David P. Marshall","David Storkey"],"categories":null,"content":"","date":1653264000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1653264000,"objectID":"acfb9dbfb17b0afe6b3b9d07719ed186","permalink":"https://afstyles.github.io/publication/spuriousforces/","publishdate":"2022-05-23T00:00:00Z","relpermalink":"/publication/spuriousforces/","section":"publication","summary":"Gyres are prominent surface structures in the global ocean circulation that often interact with the sea floor in a complex manner. Diagnostic methods, such as the depth-integrated vorticity budget, are needed to assess exactly how such model circulations interact with the bathymetry. Terms in the vorticity budget can be integrated over the area enclosed by streamlines to identify forces that spin gyres up and down. In this article we diagnose the depth-integrated vorticity budgets of both idealized gyres and the Weddell Gyre in a realistic global model. It is shown that spurious forces play a significant role in the dynamics of all gyres presented and that they are a direct consequence of the Arakawa C-grid discretization and the z-coordinate representation of the sea floor. The spurious forces include a numerical beta effect and interactions with the sea floor which originate from the discrete Coriolis force when calculated with the following schemes: the energy conserving scheme; the enstrophy conserving scheme; and the energy and enstrophy conserving scheme. Previous studies have shown that bottom pressure torques provide the main interaction between the depth-integrated flow and the sea floor. Bottom pressure torques are significant, but spurious interactions with bottom topography are similar in size. Possible methods for reducing the identified spurious topographic forces are discussed. Spurious topographic forces can be alleviated by using either a B-grid in the horizontal plane or a terrain-following vertical coordinate.","tags":[],"title":"Spurious Forces Can Dominate the Vorticity Budget of Ocean Gyres on the C-Grid","type":"publication"},{"authors":null,"categories":null,"content":"This year I will be presenting my work at the EGU 2022 conference in Vienna.\nI will be presenting my work on spurious forces in the Numerical Modelling of the Ocean session (link here).\nMy presentation will be on Wednesday, 25th May at 08:50 CEST in Room 1.15/16.\nSee you in Vienna (or online)!\n","date":1650499200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1650499200,"objectID":"d6ce4f62d76cc970a672141739351d47","permalink":"https://afstyles.github.io/post/egu-2022-presentation/","publishdate":"2022-04-21T00:00:00Z","relpermalink":"/post/egu-2022-presentation/","section":"post","summary":"This year I will be presenting my work at the EGU 2022 conference in Vienna.\nI will be presenting my work on spurious forces in the Numerical Modelling of the Ocean session (link here).","tags":null,"title":"I will be presenting at EGU 2022","type":"post"},{"authors":null,"categories":null,"content":"The preprint of my first paper is available on ESSOAr.\nIn this article we discuss how the model grid can produce dominant spurious forces in both realistic and idealized model gyres.\n","date":1635724800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1635724800,"objectID":"6df94b790d6330dbb7209409589b0261","permalink":"https://afstyles.github.io/post/preprint-post/","publishdate":"2021-11-01T00:00:00Z","relpermalink":"/post/preprint-post/","section":"post","summary":"The preprint of my first paper is available on ESSOAr.\nIn this article we discuss how the model grid can produce dominant spurious forces in both realistic and idealized model gyres.","tags":null,"title":"Preprint of first paper","type":"post"},{"authors":null,"categories":null,"content":" Note: This guide has been updated to work with NEMO 4.0.1 using Intel compilers. If for any reason you want to look at my original guide for an earlier release using GCC compilers click here\n These are my personal notes on how to set up and compile NEMO 4.0.1 on Monsoon/NEXCS.\nWhen compiling NEMO I could not find any guide for this particular system but used the following excellent guides for inspiration:\n   Julian Mak\u0026rsquo;s guide to compiling NEMO 4.0 on local machines and Oxford ARC.\n   Christopher Bull\u0026rsquo;s guide for compiling NEMO on ARCHER\n  As these guides were so helpful, I feel it is only fair to make a similar contribution.\nI must also give a huge thanks to Dr. Andrew Coward from the National Oceanography Centre who has helped me to update this guide.\nStep 1 - Loading modules Once you are logged on to the Met Office lander, connect to NEXCS using\nssh xcs-c  On logging in you need to load the correct compilers and libraries. You will not be able to compile XIOS or NEMO without loading the correct modules. You can do this by running the following shell script.\n#/bin/bash #! module swap PrgEnv-cray/5.2.82 PrgEnv-intel/5.2.82 module swap intel/15.0.0.090 intel/18.0.5.274 module load cray-hdf5-parallel/1.10.2.0 module load cray-netcdf-hdf5parallel/4.6.1.3  It will also be useful to load an editor\nmodule load nano   Note: When you log in to NEXCS a set of essential modules are loaded by default. Do not use module purge before loading the above modules.\n Your loaded modules should look like the following:\nastyles@xcslc0:~\u0026gt; module list Currently Loaded Modulefiles: 1) moose-client-wrapper 9) craype-network-aries 17) cray-libsci/13.0.1 25) alps/5.2.4-2.0502.9774.31.11.ari 2) python/v2.7.9 10) gcc/4.8.1 18) udreg/2.3.2-1.0502.10518.2.17.ari 26) rca/1.0.0-2.0502.60530.1.62.ari 3) metoffice/tempdir 11) intel/18.0.5.274 19) ugni/6.0-1.0502.10863.8.29.ari 27) atp/1.7.5 4) metoffice/userenv 12) craype/2.2.1 20) pmi/5.0.5-1.0000.10300.134.8.ari 28) PrgEnv-intel/5.2.82 5) subversion-1.8/1.8.19 13) craype-haswell 21) dmapp/7.0.1-1.0502.11080.8.76.ari 29) cray-hdf5-parallel/1.10.2.0 6) modules/3.2.10.5 14) cray-mpich/7.0.4 22) gni-headers/4.0-1.0502.10859.7.8.ari 30) cray-netcdf-hdf5parallel/4.6.1.3 7) eswrap/1.3.3-1.020200.1280.0 15) pbs/18.2.5.20190913061152 23) xpmem/0.1-2.0502.64982.5.3.ari 8) switch/1.0-1.0502.60522.1.61.ari 16) nano/2.8.6 24) dvs/2.5_0.9.0-1.0502.2188.1.116.ari  Step 2 - XIOS 2.5 XIOS controls the Input/Output for NEMO and needs to be compiled first. For NEMO 4.0 I use XIOS 2.5 but the method is very similar for other versions.\nFirst navigate to the data directory on NEXCS and make a folder for XIOS\ncd $DATADIR mkdir XIOS  Inside the folder download XIOS 2.5\ncd XIOS svn checkout -r 1566 http://forge.ipsl.jussieu.fr/ioserver/svn/XIOS/branchs/xios-2.5 xios-2.5  We need to make sure XIOS is looking in the right place for the modules loaded in Step 1. We copy and rename the following files in the arch folder\ncd xios-2.5/arch/ cp arch-XC30_Cray.env arch-XC30_NEXCS.env cp arch-XC30_Cray.fcm arch-XC30_NEXCS.fcm cp arch-XC30_Cray.path arch-XC30_NEXCS.path  Then edit the files so they look like the following\n#arch-XC30_NEXCS.env export HDF5_INC_DIR=${HDF5_DIR}/include export HDF5_LIB_DIR=${HDF5_DIR}/lib export NETCDF_INC_DIR=${NETCDF_DIR}/include export NETCDF_LIB_DIR=${NETCDF_DIR}/lib   Note: If you are using a different set of modules or worried that this path is wrong. The commands which nc-config and which h5copy will give you a path of the form directory/bin. The paths used above should then be directory/GNU/4.9/include and similar for lib\n #arch-XC30_NEXCS.fcm ################################################################################ ################### Projet XIOS ################### ################################################################################ # Cray XC build instructions for XIOS/xios-1.0 # These files have been tested on # Archer (XC30), ECMWF (XC30), and the Met Office (XC40) using the Cray PrgEnv. # One must also: # module load cray-netcdf-hdf5parallel/4.3.2 # There is a bug in the CC compiler prior to cce/8.3.7 using -O3 or -O2 # The workarounds are not ideal: # Use -Gfast and put up with VERY large executables # Use -O1 and possibly suffer a significant performance loss. # # Mike Rezny Met Office 23/03/2015 %CCOMPILER cc %FCOMPILER ftn %LINKER CC %BASE_CFLAGS -DMPICH_SKIP_MPICXX -h msglevel_4 -h zero -h noparse_templates %PROD_CFLAGS -O3 -DBOOST_DISABLE_ASSERTS %DEV_CFLAGS -g -O2 %DEBUG_CFLAGS -g %BASE_FFLAGS -warn all -zero %PROD_FFLAGS -O3 -fp-model precise -warn all -zero %DEV_FFLAGS -g -O2 %DEBUG_FFLAGS -g %BASE_INC -D__NONE__ %BASE_LD -D__NONE__ %CPP cpp %FPP cpp -P -CC %MAKE gmake   #arch-XC30_NEXCS.path NETCDF_INCDIR=\u0026quot;-I $NETCDF_INC_DIR\u0026quot; NETCDF_LIBDIR='-Wl,\u0026quot;--allow-multiple-definition\u0026quot; -Wl,\u0026quot;-Bstatic\u0026quot; -L $NETCDF_LIB_DIR' NETCDF_LIB=\u0026quot;-lnetcdf -lnetcdff\u0026quot; MPI_INCDIR=\u0026quot;\u0026quot; MPI_LIBDIR=\u0026quot;\u0026quot; MPI_LIB=\u0026quot;\u0026quot; #HDF5_INCDIR=\u0026quot;-I $HDF5_INC_DIR\u0026quot; HDF5_LIBDIR=\u0026quot;-L $HDF5_LIB_DIR\u0026quot; HDF5_LIB=\u0026quot;-lhdf5_hl -lhdf5 -lz\u0026quot; OASIS_INCDIR=\u0026quot;\u0026quot; OASIS_LIBDIR=\u0026quot;\u0026quot; OASIS_LIB=\u0026quot;\u0026quot; #OASIS_INCDIR=\u0026quot;-I$PWD/../../prism/X64/build/lib/psmile.MPI1\u0026quot; #OASIS_LIBDIR=\u0026quot;-L$PWD/../../prism/X64/lib\u0026quot; #OASIS_LIB=\u0026quot;-lpsmile.MPI1 -lmpp_io\u0026quot;  Then you need to edit bld.cfg in xios-2.5/\ncd $DATADIR/XIOS/xios-2.5  and change all occurrences of src_netcdf to src_netcdf4 (two in total)\nYou are now ready to compile XIOS. In xios-2.5/\n./make_xios --full --prod --arch XC30_NEXCS -j2  If this build is successful then XIOS is ready to use. If not, check over the arch files and make sure the flags are correct and in the right order. Also make sure you have the correct modules loaded. Getting XIOS to compile is by far the most difficult part of the process.\nStep 3 - NEMO 4.0 Now we have XIOS ready to go we can start working on NEMO 4.0.\nGo back to the data directory and create a new folder for NEMO\ncd $DATADIR mkdir NEMO  Then download NEMO 4.0.1 in the folder.\ncd NEMO svn co https://forge.ipsl.jussieu.fr/nemo/svn/NEMO/releases/release-4.0.1  Now we need to copy and update the arch files for NEMO like we did in XIOS.\ncd release-4.0.1/arch/ cp arch-linux_ifort.fcm arch-XC_MONSOON_INTEL.fcm  The file arch-XC_MONSOON_INTEL.fcm needs to look like\n#arch-XC_MONSOON_INTEL.fcm %NCDF_HOME $NETCDF_DIR %HDF5_HOME $HDF5_DIR %XIOS_HOME $DATADIR/XIOS/xios-2.5 #OASIS_HOME %NCDF_INC -I%NCDF_HOME/include -I%HDF5_HOME/include %NCDF_LIB -L%HDF5_HOME/lib -L%NCDF_HOME/lib -lnetcdff -lnetcdf -lhdf5_hl -lhdf5 -lz %XIOS_INC -I%XIOS_HOME/inc %XIOS_LIB -L%XIOS_HOME/lib -lxios #OASIS_INC -I%OASIS_HOME/build/lib/mct -I%OASIS_HOME/build/lib/psmile.MPI1 #OASIS_LIB -L%OASIS_HOME/lib -lpsmile.MPI1 -lmct -lmpeu -lscrip %CPP cpp %FC ftn %FCFLAGS -integer-size 32 -real-size 64 -O3 -fp-model source -zero -fpp -warn all %FFLAGS -integer-size 32 -real-size 64 -O3 -fp-model source -zero -fpp -warn all %LD CC -Wl,\u0026quot;--allow-multiple-definition\u0026quot; %FPPFLAGS -P -C -traditional %LDFLAGS %AR ar %ARFLAGS -rvs %MK gmake %USER_INC %XIOS_INC %NCDF_INC %USER_LIB %XIOS_LIB %NCDF_LIB #USER_INC %XIOS_INC %OASIS_INC %NCDF_INC ##USER_LIB %XIOS_LIB %OASIS_LIB %NCDF_LIB %CC cc %CFLAGS -O0  Step 4 - Compiling the GYRE_PISCES configuration Now we need a configuration to compile. In this example I use GYRE_PISCES which is a reference configuration in NEMO as it is a relatively simple configuration. Other reference configurations are listed here and the process will be similar.\nCopy the reference configuration you like to use by doing the following.\ncd $DATADIR/NEMO/release-4.0.1/cfgs mkdir GYRE_testing rsync -arv GYRE_PISCES/* GYRE_testing  Then go into GYRE_testing, rename the cpp_GYRE_PISCES.fcm file.\ncd GYRE_testing mv cpp_GYRE_PISCES.fcm cpp_GYRE_testing.fcm  Then edit the same file and replace key_top with key_nosignedzero.\n In cfgs/ edit the file ref_cfgs.txt and add your configuration to the bottom of the list. For this example the file looks like.\nAGRIF_DEMO OCE ICE NST AMM12 OCE C1D_PAPA OCE GYRE_BFM OCE TOP GYRE_PISCES OCE TOP ORCA2_OFF_PISCES OCE TOP OFF ORCA2_OFF_TRC OCE TOP OFF ORCA2_SAS_ICE OCE ICE NST SAS ORCA2_ICE_PISCES OCE TOP ICE NST SPITZ12 OCE ICE GYRE_testing OCE TOP   Note: Make sure the OCE/TOP/\u0026hellip; flags match the reference configuration you are using\n You are now ready to compile nemo. Make sure you have all the modules in Step 1 loaded. Go back to the base directory and do the following\ncd $DATADIR/NEMO/release-4.0.1 ./makenemo -j2 -r GYRE_testing -m linux_NEXCS  If all has gone well you have successfully compiled NEMO!\nStep 5 - Using NEMO on NEXCS Now that you have compiled NEMO, you probably want to run it.\nNEMO runs in parallel and will output a data file for each thread used. Therefore we need the REBUILD_NEMO tool to recombine the outputs into a single file.\nTo do this go to the tools folder and execute the following command:\ncd $DATADIR/NEMO/nemo4.0-9925/tools ./maketools -n REBUILD_NEMO -m linux_NEXCS   Note: If you get an error about iargc_ and/or getarg not being external variables then go to the following file tools/REBUILD_NEMO/src/rebuild_nemo.F90 and comment out these two lines.\nINTEGER, EXTERNAL :: iargc ... external :: getarg  Depending on the compiler used these may or may not be treated as external variables.\n Now go back to your configuration and create a symbolic link to xios_server.exe\ncd $DATADIR/NEMO/release-4.0.1/cfgs/GYRE_testing/EXP00 ln -s $DATADIR/XIOS/xios-2.5/bin/xios_server.exe .  Also modify iodef.xml and set using_server to true\n\u0026lt;variable id=\u0026quot;using_server\u0026quot; type=\u0026quot;bool\u0026quot;\u0026gt;true\u0026lt;/variable\u0026gt;  Make an OUTPUTS/ and RESTARTS/ directory in EXP00\nmkdir OUTPUTS RESTARTS  You also need to add a shell script for post processing to EXP00. The one I use below is a modified version of Julian Mak\u0026rsquo;s post processing script. It is too long to show on this page but you can find it here and it should work for this example. The only values that need changing are NUM_DOM(how many nodes is NEMO using) and NUM_CPU (how many cpus in total).\nTo run a job on NEXCS you need to use a submission script like the one below. Yet again this is a modification of Julian\u0026rsquo;s submission script.\n#!/bin/bash #! ##subm_script.pbs #PBS -q nexcs #PBS -A user ##Username #PBS -l select=3 ##(Number of nodes running NEMO + Number of nodes running XIOS) #PBS -l walltime=00:10:00 ##Maximum runtime #PBS -N GYRE_testing ##Name of run in queue #PBS -o testing.output ##Name of output file #PBS -e testing.error ##Name of error file #PBS -j oe #PBS -V cd $DATADIR/NEMO/release-4.0.1/cfgs/GYRE_testing/EXP00/ echo \u0026quot; _ __ ___ _ __ ___ ___ \u0026quot; echo \u0026quot;| '_ \\ / _ \\ '_ ' _ \\ / _ \\ \u0026quot; echo \u0026quot;| | | | __/ | | | | | (_) | \u0026quot; echo \u0026quot;|_| |_|\\___|_| |_| |_|\\___/ v4.0 \u0026quot; export OCEANCORES=64 #Number of cores used (32 per node running NEMO) export XIOSCORES=2 #Number of cores to run XIOS (=number of nodes running NEMO) ulimit -c unlimited ulimit -s unlimited aprun -b -n $XIOSCORES -N 2 ./xios_server.exe : -n $OCEANCORES -N 32 ./nemo #=============================================================== # POSTPROCESSING #=============================================================== # kills the daisy chain if there are errors if grep -q 'E R R O R' ocean.output ; then echo \u0026quot;E R R O R found, exiting...\u0026quot; echo \u0026quot; ___ _ __ _ __ ___ _ __ \u0026quot; echo \u0026quot; / _ \\ '__| '__/ _ \\| '__| \u0026quot; echo \u0026quot;| __/ | | | | (_) | | \u0026quot; echo \u0026quot; \\___|_| |_| \\___/|_| \u0026quot; echo \u0026quot;check out ocean.output or stdouterr to see what the deal is \u0026quot; exit else echo \u0026quot;going into postprocessing stage...\u0026quot; # cleans up files, makes restarts, moves files, resubmits this pbs bash ./postprocess.sh \u0026gt;\u0026amp; cleanup.log exit fi  This script uses two nodes (each with 32 cores) to run NEMO and an additional node to run XIOS.\n Note: For the postprocessing to work the number of nodes used for NEMO (not XIOS) must = NUM_DOM and the number of cores for NEMO = NUM_CPU\n Submit this script by doing\nqsub subm_script.pbs  Check the status of the submitted job using qstat\nIf all goes well you should have outputs in the OUTPUTS/ folder. If not, check testing.output and ocean.output to see what the issue is.\n Note: Make sure you have the modules mentioned in Step 1 loaded when submitting\n Note: If you have an error referring to namberg have a look in namelist_refand look for a comment character ! right next to a variable.\n.true.!comment  If found, add a space.\n.true. !comment   Congratulations, you have successfully compiled and run NEMO!\n","date":1603843200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1603843200,"objectID":"14f3792736476d67e8b0db9a1d97550f","permalink":"https://afstyles.github.io/nemo-compilation/","publishdate":"2020-10-28T00:00:00Z","relpermalink":"/nemo-compilation/","section":"","summary":"A guide to compiling NEMO 4.0 on Monsoon/NEXCS.","tags":null,"title":"Compiling NEMO 4.0.1 on Monsoon/NEXCS","type":"page"},{"authors":null,"categories":null,"content":"Check out my new updated guide here\n","date":1603843200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1603843200,"objectID":"86c3f2119b67b11243d17fa2cdd2be82","permalink":"https://afstyles.github.io/post/nemo-compilation-post-update-one/","publishdate":"2020-10-28T00:00:00Z","relpermalink":"/post/nemo-compilation-post-update-one/","section":"post","summary":"Check out my new updated guide here","tags":null,"title":"NEMO compilation guide updated","type":"post"},{"authors":null,"categories":null,"content":" Note this guide has been updated here to work with a later release of NEMO using intel compilers. This guide still works but I would advise using the more up-to-date guide.\n These are my personal notes on how to set up and compile NEMO 4.0 on NEXCS.\nNEXCS is the NERC partition of the Met Office Cray XC40 supercomputer and has a similar infrastructure to Monsoon2.\nWhen compiling NEMO I could not find any guide for this particular system but used the following excellent guides for inspiration:\n   Julian Mak\u0026rsquo;s guide to compiling NEMO 4.0 on local machines and Oxford ARC.\n   Christopher Bull\u0026rsquo;s guide for compiling NEMO on ARCHER\n  As these guides were so helpful, I feel it is only fair to make a similar contribution.\nStep 1 - Loading modules Once you are logged on to the Met Office lander, connect to NEXCS using\nssh xcs-c  On logging in you need to load the correct compilers and libraries. You will not be able to compile XIOS or NEMO without loading the correct modules. First load the netcdf and hdf5 libraries.\nmodule load cray-netcdf-hdf5parallel/4.4.1 module load cray-hdf5-parallel/1.10.0  Switch to a more recent version of mpich.\nmodule swap cray-mpich/7.0.4 cray-mpich/7.3.1  Finally switch from the Cray environment to the GNU environment\nmodule swap PrgEnv-cray/5.2.82 PrgEnv-gnu/5.2.82  It will also be useful to load an editor\nmodule load nano   Note: When you log in to NEXCS a set of essential modules are loaded by default. Do not use module purge before loading the above modules.\n You loaded modules should look like the following:\nuser@xcslc0:~\u0026gt; module list 1) moose-client-wrapper 9) craype-network-aries 17) cray-hdf5-parallel/1.10.0 25) dvs/2.5_0.9.0-1.0502.2188.1.116.ari 2) python/v2.7.9 10) gcc/4.9.1 18) cray-libsci/13.0.1 26) alps/5.2.4-2.0502.9774.31.11.ari 3) metoffice/tempdir 11) craype/2.2.1 19) udreg/2.3.2-1.0502.10518.2.17.ari 27) rca/1.0.0-2.0502.60530.1.62.ari 4) metoffice/userenv 12) craype-haswell 20) ugni/6.0-1.0502.10863.8.29.ari 28) atp/1.7.5 5) subversion-1.8/1.8.19 13) cray-mpich/7.3.1 21) pmi/5.0.5-1.0000.10300.134.8.ari 29) PrgEnv-gnu/5.2.82 6) modules/3.2.10.5 14) pbs/18.2.5.20190913061152 22) dmapp/7.0.1-1.0502.11080.8.76.ari 7) eswrap/1.3.3-1.020200.1280.0 15) nano/2.8.6 23) gni-headers/4.0-1.0502.10859.7.8.ari 8) switch/1.0-1.0502.60522.1.61.ari 16) cray-netcdf-hdf5parallel/4.4.1 24) xpmem/0.1-2.0502.64982.5.3.ari  Step 2 - XIOS 2.5 XIOS controls the Input/Output for NEMO and needs to be compiled first. For NEMO 4.0 I use XIOS 2.5 but the method is very similar for other versions.\nFirst navigate to the data directory on NEXCS and make a folder for XIOS\ncd $DATADIR mkdir XIOS  Inside the folder download XIOS 2.5\ncd XIOS svn checkout -r 1566 http://forge.ipsl.jussieu.fr/ioserver/svn/XIOS/branchs/xios-2.5 xios-2.5  We need to make sure XIOS is looking in the right place for the modules loaded in Step 1. We copy and rename the following files in the arch folder\ncd xios-2.5/arch/ cp arch-GCC_LINUX.env arch-GCC_NEXCS.env cp arch-GCC_LINUX.fcm arch-GCC_NEXCS.fcm cp arch-GCC_LINUX.path arch-GCC_NEXCS.path  Then edit the files so they look like the following\n#arch-GCC_NEXCS.env export HDF5_INC_DIR=/opt/cray/hdf5/1.10.0/GNU/4.9/include export HDF5_LIB_DIR=/opt/cray/hdf5/1.10.0/GNU/4.9/lib export NETCDF_INC_DIR=/opt/cray/netcdf/4.4.1/GNU/4.9/include export NETCDF_LIB_DIR=/opt/cray/netcdf/4.4.1/GNU/4.9/lib   Note: If you are using a different set of modules or worried that this path is wrong. The commands which nc-config and which h5copy will give you a path of the form directory/bin. The paths used above should then be directory/GNU/4.9/include and similar for lib\n #arch-GCC_NEXCS.fcm ################################################################################ ################### Projet XIOS ################### ################################################################################ %CCOMPILER cc %FCOMPILER ftn %LINKER CC %BASE_CFLAGS -ansi -w %PROD_CFLAGS -O3 -DBOOST_DISABLE_ASSERTS %DEV_CFLAGS -g -O2 %DEBUG_CFLAGS -g %BASE_FFLAGS -D__NONE__ %PROD_FFLAGS -O3 %DEV_FFLAGS -g -O2 %DEBUG_FFLAGS -g %BASE_INC -D__NONE__ %BASE_LD -lstdc++ %CPP cpp %FPP cpp -P %MAKE gmake   #arch-GCC_NEXCS.path NETCDF_INCDIR=\u0026quot;-I $NETCDF_INC_DIR\u0026quot; NETCDF_LIBDIR=\u0026quot;-Wl,'--allow-multiple-definition' -L$NETCDF_LIB_DIR\u0026quot; NETCDF_LIB=\u0026quot;-lnetcdff -lnetcdf\u0026quot; MPI_INCDIR=\u0026quot;\u0026quot; MPI_LIBDIR=\u0026quot;\u0026quot; MPI_LIB=\u0026quot;\u0026quot; HDF5_INCDIR=\u0026quot;-I $HDF5_INC_DIR\u0026quot; HDF5_LIBDIR=\u0026quot;-L $HDF5_LIB_DIR\u0026quot; HDF5_LIB=\u0026quot;-lhdf5_hl -lhdf5 -lhdf5 -lz\u0026quot;   Then you need to edit bld.cfg in xios-2.5/\ncd $DATADIR/XIOS/xios-2.5  and change all occurrences of src_netcdf to src_netcdf4 (two in total)\nYou are now ready to compile XIOS. In xios-2.5/\n./make_xios --full --prod --arch GCC_NEXCS -j2  If this build is successful then XIOS is ready to use. If not, check over the arch files and make sure the flags are correct and in the right order. Also make sure you have the correct modules loaded. Getting XIOS to compile is by far the most difficult part of the process.\nStep 3 - NEMO 4.0 Now we have XIOS ready to go we can start working on NEMO 4.0.\nGo back to the data directory and create a new folder for NEMO\ncd $DATADIR mkdir NEMO  Then download NEMO 4.0 in the folder.\ncd NEMO svn checkout -r 9925 http://forge.ipsl.jussieu.fr/nemo/svn/NEMO/trunk nemo4.0-9925  Now we need to copy and update the arch files for NEMO like we did in XIOS.\ncd nemo4.0-9925/arch/ cp arch-linux_ifort.fcm arch-linux_NEXCS.fcm  The file arch-linux_NEXCS.fcm needs to look like\n#arch-linux_NEXCS.fcm %NCDF_HOME /opt/cray/netcdf/4.4.1/GNU/4.9 %HDF5_HOME /opt/cray/hdf5/1.10.0/GNU/4.9 %XIOS_HOME /projects/nexcs-n02/user/XIOS/xios-2.5 %NCDF_INC -I%NCDF_HOME/include -I%HDF5_HOME/include %NCDF_LIB -L%NCDF_HOME/lib -lnetcdf -lnetcdff -lstdc++ %XIOS_INC -I%XIOS_HOME/inc %XIOS_LIB -L%XIOS_HOME/lib -lxios -lstdc++ %CPP cpp %FC ftn %FCFLAGS -fdefault-real-8 -O3 -funroll-all-loops -fcray-pointer -cpp -ffree-line-length-none %FFLAGS %FCFLAGS %LD %FC %FPPFLAGS -P -C -traditional %LDFLAGS %AR ar %ARFLAGS -rs %MK make %USER_INC %XIOS_INC %NCDF_INC %USER_LIB %XIOS_LIB %NCDF_LIB %CC cc  Step 4 - Compiling the GYRE_PISCES configuration Now we need a configuration to compile. In this example I use GYRE_PISCES which is a reference configuration in NEMO as it is a relatively simple configuration. Other reference configurations are listed here and the process will be similar.\nCopy the reference configuration you like to use by doing the following.\ncd $DATADIR/NEMO/nemo4.0-9925/cfgs mkdir GYRE_testing rsync -arv GYRE_PISCES/* GYRE_testing  Then go into GYRE_testing, rename the cpp_GYRE_PISCES.fcm file.\ncd GYRE_testing mv cpp_GYRE_PISCES.fcm cpp_GYRE_testing.fcm  Then edit the same file and replace key_top with key_nosignedzero.\n In cfgs/ edit the file ref_cfgs.txt and add your configuration to the bottom of the list. For this example the file looks like.\nAGRIF_DEMO OCE ICE NST AMM12 OCE C1D_PAPA OCE GYRE_BFM OCE TOP GYRE_PISCES OCE TOP ORCA2_OFF_PISCES OCE TOP OFF ORCA2_OFF_TRC OCE TOP OFF ORCA2_SAS_ICE OCE ICE NST SAS ORCA2_ICE_PISCES OCE TOP ICE NST SPITZ12 OCE ICE GYRE_testing OCE TOP   Note: Make sure the OCE/TOP/\u0026hellip; flags match the reference configuration you are using\n You are now ready to compile nemo. Make sure you have all the modules in Step 1 loaded. Go back to the base directory and do the following\ncd $DATADIR/NEMO/nemo4.0-9925 ./makenemo -j2 -r GYRE_testing -m linux_NEXCS  If all has gone well you have successfully compiled NEMO!\nStep 5 - Using NEMO on NEXCS Now that you have compiled NEMO, you probably want to run it.\nNEMO runs in parallel and will output a data file for each thread used. Therefore we need the REBUILD_NEMO tool to recombine the outputs into a single file.\nTo do this go to the tools folder and execute the following command:\ncd $DATADIR/NEMO/nemo4.0-9925/tools ./maketools -n REBUILD_NEMO -m linux_NEXCS   Note: If you get an error about iargc_ and/or getarg not being external variables then go to the following file tools/REBUILD_NEMO/src/rebuild_nemo.F90 and comment out these two lines\nINTEGER, EXTERNAL :: iargc ... external :: getarg  These are not external variables in Fortran 90.\n Now go back to your configuration and create a symbolic link to xios_server.exe\ncd $DATADIR/NEMO/nemo4.0-9925/cfgs/GYRE_testing/EXP00 ln -s $DATADIR/XIOS/xios-2.5/bin/xios_server.exe .  Also modify iodef.xml and set using_server to true\n\u0026lt;variable id=\u0026quot;using_server\u0026quot; type=\u0026quot;bool\u0026quot;\u0026gt;true\u0026lt;/variable\u0026gt;  Make an OUTPUTS/ and RESTARTS/ directory in EXP00\nmkdir OUTPUTS RESTARTS  You also need to add a shell script for post processing to EXP00. The one I use below is a modified version of Julian Mak\u0026rsquo;s post processing script. It is too long to show on this page but you can find it here and it should work for this example. The only values that need changing are NUM_DOM(how many nodes is NEMO using) and NUM_CPU (how many cpus in total).\nTo run a job on NEXCS you need to use a submission script like the one below. Yet again this is a modification of Julian\u0026rsquo;s submission script.\n#!/bin/bash #! ##subm_script.pbs #PBS -q nexcs #PBS -A user ##Username #PBS -l select=3 ##(Number of nodes running NEMO + Number of nodes running XIOS) #PBS -l walltime=00:10:00 ##Maximum runtime #PBS -N GYRE_testing ##Name of run in queue #PBS -o testing.output ##Name of output file #PBS -e testing.error ##Name of error file #PBS -j oe #PBS -V cd $DATADIR/NEMO/nemo4.0-9925/cfgs/GYRE_testing/EXP00/ echo \u0026quot; _ __ ___ _ __ ___ ___ \u0026quot; echo \u0026quot;| '_ \\ / _ \\ '_ ' _ \\ / _ \\ \u0026quot; echo \u0026quot;| | | | __/ | | | | | (_) | \u0026quot; echo \u0026quot;|_| |_|\\___|_| |_| |_|\\___/ v4.0 \u0026quot; export OCEANCORES=64 #Number of cores used (32 per node running NEMO) export XIOSCORES=2 #Number of cores to run XIOS (=number of nodes running NEMO) ulimit -c unlimited ulimit -s unlimited aprun -b -n $XIOSCORES -N 2 ./xios_server.exe : -n $OCEANCORES -N 32 ./nemo #=============================================================== # POSTPROCESSING #=============================================================== # kills the daisy chain if there are errors if grep -q 'E R R O R' ocean.output ; then echo \u0026quot;E R R O R found, exiting...\u0026quot; echo \u0026quot; ___ _ __ _ __ ___ _ __ \u0026quot; echo \u0026quot; / _ \\ '__| '__/ _ \\| '__| \u0026quot; echo \u0026quot;| __/ | | | | (_) | | \u0026quot; echo \u0026quot; \\___|_| |_| \\___/|_| \u0026quot; echo \u0026quot;check out ocean.output or stdouterr to see what the deal is \u0026quot; exit else echo \u0026quot;going into postprocessing stage...\u0026quot; # cleans up files, makes restarts, moves files, resubmits this pbs bash ./postprocess.sh \u0026gt;\u0026amp; cleanup.log exit fi  This script uses two nodes (each with 32 cores) to run NEMO and an additional node to run XIOS.\n Note: For the postprocessing to work the number of nodes used for NEMO (not XIOS) must = NUM_DOM and the number of cores for NEMO = NUM_CPU\n Submit this script by doing\nqsub subm_script.pbs  Check the status of the submitted job using qstat\nIf all goes well you should have outputs in the OUTPUTS/ folder. If not, check testing.output and ocean.output to see what the issue is.\n Note: Make sure you have the modules mentioned in Step 1 loaded when submitting\n Note: If you have an error referring to namberg have a look in namelist_refand look for a comment character ! right next to a variable.\n.true.!comment  If found, add a space.\n.true. !comment   Congratulations, you have successfully compiled and run NEMO!\n","date":1590624000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1590624000,"objectID":"0663ab97dcc954c87f577e3048e77e7c","permalink":"https://afstyles.github.io/nemo-compilation-archive/","publishdate":"2020-05-28T00:00:00Z","relpermalink":"/nemo-compilation-archive/","section":"","summary":"A guide to compiling NEMO 4.0 on NEXCS.","tags":null,"title":"Compiling NEMO 4.0 on NEXCS","type":"page"},{"authors":null,"categories":null,"content":"Check out my guide to compile NEMO on NEXCS here\n","date":1590624000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1590624000,"objectID":"001289cce087a97836d670b4f0675c4f","permalink":"https://afstyles.github.io/post/nemo-compilation-post/","publishdate":"2020-05-28T00:00:00Z","relpermalink":"/post/nemo-compilation-post/","section":"post","summary":"Check out my guide to compile NEMO on NEXCS here","tags":null,"title":"Compiling NEMO on NEXCS","type":"post"},{"authors":null,"categories":null,"content":"Submitted  Styles, A. F., MacGilchrist, G. A., Bell, M. J., \u0026amp; Marshall, D. P. (Subm. 2023) Spatial and Temporal Patterns of Southern Ocean Ventilation. Geophysical Research Letters [ Preprint ]  2023   Styles, A. F., Bell, M. J., \u0026amp; Marshall, D. P. (2023). The Sensitivity of an Idealized Weddell Gyre to Horizontal Resolution. Journal of Geophysical Research: Oceans, 128, e2023JC019711. https://doi.org/10.1029/2023JC019711\n  Sallée, J. B., and co-authors including Styles, A. F. (2023). Southern Ocean Carbon and Heat Impact on Climate. Philosophical Transactions of the Royal Society A, 381(2249), 20220056. http://doi.org/10.1098/rsta.2022.0056\n  2022  Styles, A. F., Bell, M. J., Marshall, D. P., \u0026amp; Storkey, D. (2022). Spurious forces can dominate the vorticity budget of ocean gyres on the C-grid. Journal of Advances in Modeling Earth Systems, 14, e2021MS002884. https://doi.org/10.1029/2021MS002884  ","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"23d1e75f872528fc12f5f2b142375ff7","permalink":"https://afstyles.github.io/publications/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/publications/","section":"","summary":"A list of all publications","tags":null,"title":"Publications","type":"page"}]